<!DOCTYPE html>
<html lang="fr" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Admin - Liste des utilisateurs</title>
    <link rel="stylesheet" href="https://cdn.metroui.org.ua/current/metro.css">
</head>
<body>

<header class="app-bar">
    <div class="container">
        <h1>Administration - Utilisateurs</h1>
    </div>
</header>

<main class="container mt-4">

    <div class="d-flex flex-justify-between mb-2">
        <!-- Formulaire de recherche -->
        <form th:action="@{/admin}" method="get" class="d-flex">
            <input type="text" name="search" placeholder="Rechercher..." th:value="${search}" />
            <button type="submit" class="button ml-2">Rechercher</button>
        </form>
    </div>

    <!-- Tableau des utilisateurs -->
    <table class="table striped">
        <thead>
        <tr>
            <th>ID</th>
            <th>Prénom</th>
            <th>Nom</th>
            <th>Email</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="user : ${myusers}">
            <td th:text="${user.id}"></td>
            <td th:text="${user.firstname}"></td>
            <td th:text="${user.lastname}"></td>
            <td th:text="${user.email}"></td>
            <td>
                <span th:if="${user.status}" style="color:green;">&#10004;</span>
                <span th:unless="${user.status}" style="color:red;">&#10006;</span>
            </td>
            <td>
                <a class="button small info" th:href="@{/admin/users/edit/{id}(id=${user.id})}">Éditer</a>
                <a class="button small alert" th:href="@{/admin/users/delete/{id}(id=${user.id})}"
                   onclick="return confirm('Supprimer cet utilisateur ?');">Supprimer</a>
            </td>
        </tr>
        </tbody>
    </table>

    <!-- Pagination -->
    <ul class="pagination">
        <li th:classappend="${currentPage == 0} ? 'disabled'">
            <a th:href="@{/admin(page=${previousPage}, search=${search})}">Précédent</a>
        </li>

        <li th:each="i : ${#numbers.sequence(0, totalPages - 1)}"
            th:classappend="${i == currentPage} ? 'active'">
            <a th:href="@{/admin(page=${i}, search=${search})}" th:text="${i + 1}">1</a>
        </li>

        <li th:classappend="${currentPage == totalPages - 1} ? 'disabled'">
            <a th:href="@{/admin(page=${nextPage}, search=${search})}">Suivant</a>
        </li>
    </ul>

    <a th:href="@{/register}" class="btn btn-primary">Ajouter un utilisateur</a>


</main>

<footer class="app-bar fixed-bottom bg-dark fg-white p-2 text-center">
    <span>&copy; 2025 - Admin Panel</span>
</footer>

<script src="https://cdn.metroui.org.ua/current/metro.js"></script>
</body>
</html>
