<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>Créer un canal de discussion</title>
    <link rel="stylesheet" href="https://cdn.metroui.org.ua/current/metro.css" />
</head>
<body>

<header class="container">
    <h1>Créer un canal de discussion</h1>
</header>

<main class="container mt-4">

    <form th:action="@{/chatroom/create}" method="get">
        <!-- Barre de recherche -->
        <input type="text" name="search" th:value="${search}" placeholder="Rechercher un utilisateur..." />

        <!-- Liste des utilisateurs -->
        <div th:each="user : ${users}">
            <label>
                <input type="checkbox" name="userIds"
                       th:value="${user.id}"
                       th:checked="${selectedUserIds != null and #lists.contains(selectedUserIds, user.id)}" />
                <span th:text="${user.firstname} + ' ' + ${user.lastname}">Nom</span>
            </label>
        </div>

        <button type="submit">Rechercher / Mettre à jour</button>
    </form>

    <form th:action="@{/chatroom/create}" th:object="${chatroom}" method="post">

        <!-- Tous les utilisateurs déjà sélectionnés mais invisibles -->
        <div th:each="id : ${selectedUserIds}">
            <input type="hidden" name="userIds" th:value="${id}" />
        </div>

        <div class="form-group">
            <label for="title">Titre :</label>
            <input type="text" id="title" th:field="*{channel}" class="input" required />
        </div>

        <div class="form-group">
            <label for="description">Description :</label>
            <textarea id="description" th:field="*{description}" class="input"></textarea>
        </div>

        <div class="form-group">
            <label for="startDateTime">Date et heure :</label>
            <input type="datetime-local" id="startDateTime" th:field="*{date}" class="input" required />
        </div>

        <div class="form-group">
            <label for="duration">Durée (nombre de jours) :</label>
            <input type="number" id="duration" th:field="*{lifespan}" min="1" class="input" required />
        </div>


        <div class="form-group mt-4">
            <button type="submit" class="button success">Créer le canal</button>
        </div>
    </form>

</main>

<script src="https://cdn.metroui.org.ua/current/metro.js"></script>
</body>
</html>
